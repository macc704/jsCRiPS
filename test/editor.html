<!DOCTYPE html>
<html>
<head lang='en'>
    <meta charset='UTF-8'>
    <title></title>
    <style type='text/css'>
        #editor {
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
        }

        .default_highlight_line {
            background-color: #c3f2c7;
            position: absolute;
        }

    </style>
    <script>
        function resizeFrame() {
            var PageHight = document.body.scrollHeight; // ページの高さを取得
            window.parent.document.getElementById('editorFrame').style.height = PageHight + 'px';
        }
    </script>
    <script src='http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js'></script>
</head>
<body>
<div id='editor'>var t = createTurtle();
for(var i=0;i<12;i++){
t.fd(10);
t.rt(30);
}
</div>

<div id='dummy' style='display: none'>dummy</div>

<script src='../lib/src-noconflict/ace.js'></script>
<script>
    var editor = ace.edit('editor');
    editor.setTheme('ace/theme/monokai');
    editor.getSession().setMode('ace/mode/javascript');
    editor.$blockScrolling = Infinity;

    $(document).ready(function () {
        var loadFile = function (path) {
            $('#dummy').load(path,
                    function (response, status) {
                        if (status === 'error') {
                            println('ERROR ファイル[' + path + ']が見つかりません')
                        } else {
                            paste(response);
                        }
                    });
        };
        loadFile('file:///C:/Users/cs11054/Documents/jsCRiPS/test/examples/2.2.1.1_House.js');
    });

    // 自動でリサイズする設定だったもの
    // function heightUpdateFunction() {
    //     // http://stackoverflow.com/questions/11584061/
    //     var newHeight = editor.getSession().getScreenLength()
    //             * editor.renderer.lineHeight + 20;
    //     window.parent.$('#editorFrame').height(newHeight.toString() + 'px');
    //     //  いらない？  $('#editor-section').height(newHeight.toString() + 'px');

    //     // This call is required for the editor to fix all of
    //     // its inner structure for adapting to a change in size
    //     editor.resize();
    // }

    // Set initial size to match initial content
    //  heightUpdateFunction();
    // Whenever a change happens inside the ACE editor, update
    // the size again
    //editor.getSession().on('change', heightUpdateFunction);


    function getSource() {
        return editor.getValue();
    }

    function paste(str) {
        editor.getSession().setValue(str);
    }

    function setFontSize(n) {
        editor.setFontSize(n);
        heightUpdateFunction();
    }

    function setTheme(theme) {
        editor.setTheme(theme);
    }

    var range = null;
    function setHighlight(startLine, endLine, type) {
        var session = editor.getSession();
        if (typeof type === 'undefined') {
            range = session.highlightLines(startLine, endLine, "error_line");
        }
    }

    function removeHighlight() {
        var session = editor.getSession();
        session.removeMarker(range.id);
    }


    // TODO いいライブラリが見つからない
    function format() {
//        var input = editor.getValue();
//        editor.getSession().setValue();
    }
    format();
</script>
</body>
</html>